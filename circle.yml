machine:
  timezone: Asia/Tokyo

dependencies:
  pre:
    - git config --global user.name "CircleCI"
    - git config --global user.email "circleci@example.com"

deployment:
  master:
    branch: master
    commands:
      - git clone git@github.com:kongou-ae/chatmine.git chatmine
      - cd chatmine && npm install
      - cd chatmine && ./node_modules/.bin/gulp deploy
      - cd chatmine && git add chatmine-win32-ia32.zip chatmine-win32-x64.zip
      - cd chatmine && git commit -m "release"
      - cd chatmine &&  tag -a `cat package.json | jq .version -r` -m "release"
      - cd chatmine && git push origin master
